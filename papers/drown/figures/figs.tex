% \ns (``number space''): Insert space equivalent to a number, to avoid needing leading zeros to align numbers in tables; first argument specifies a multiplier (AH 4/2016)
%     Example: 100%\\ \ns 50% \\ \ns[2] 1%
\newlength{\nswidth}\newcommand{\ns}[1][1]{\settowidth{\nswidth}{0}\hspace{#1\nswidth}}

\newcommand{\tabDrownAll}{
  \begin{table*}[t]
  \centering\small
  \begin{tabularx}{\textwidth}{Xrrrrrrr} 
  \toprule
  & & \multicolumn{3}{c}{\it Any certificate} & \multicolumn{3}{c}{\it Trusted certificates} \\
  \cmidrule(lr){3-5} \cmidrule(lr){6-8}
  \textbf{Protocol} & \textbf{Port} & \textbf{SSL/TLS}  & \twolinecell{\bf \ssltwo \\\bf support}        & \twolinecell{\bf Vulnerable\\\bf key} & \textbf{SSL/TLS} & \twolinecell{\bf \ssltwo\\\bf support} &  \twolinecell{\bf Vulnerable \\\bf key} \\
  \midrule
  SMTP     & 25  & 3,357\,K &   936\,K (28\%)  & 1,666\,K (50\%)  &  1,083\,K  &   190\,K (18\%) & 686\,K (63\%)   \\
  POP3     & 110 & 4,193\,K &   404\,K (10\%)  & 1,764\,K (42\%)  &  1,787\,K  &   230\,K (13\%) & 1,031\,K (58\%) \\
  IMAP     & 143 & 4,202\,K &   473\,K (11\%)  & 1,759\,K (42\%)  &  1,781\,K  &   223\,K (13\%) & 1,022\,K (57\%) \\
  HTTPS    & 443 & 34,727\,K& 5,975\,K (17\%)  & 11,444\,K (33\%) &  17,490\,K & 1,749\,K (10\%) & 3,931\,K (22\%) \\
  SMTPS    & 465 & 3,596\,K &   291\,K \ns (8\%)   & 1,439\,K (40\%)  &  1,641\,K  &     40\,K \ns (2\%) & 949\,K (58\%)   \\
  SMTP     & 587 & 3,507\,K &   423\,K (12\%)  & 1,464\,K (42\%)  &  1,657\,K  &    133\,K \ns (8\%) & 986\,K (59\%)   \\
  IMAPS    & 993 & 4,315\,K &   853\,K (20\%)  & 1,835\,K (43\%)  &  1,909\,K  &   260\,K (14\%) & 1,119\,K (59\%) \\
  POP3S    & 995 & 4,322\,K &   884\,K (20\%)  & 1,919\,K (44\%)  &  1,974\,K  &   304\,K (15\%) & 1,191\,K (60\%) \\
  \midrule
  (Alexa~Top~1M) & 443 & 611\,K   & 82\,K (13\%)     & 152\,K (25\%)  & 456\,K     & 38\,K \ns (8\%)     & 109\,K (24\%)   \\
%% \ifext
%% \else
%%   \midrule
%%   \bf Special DROWN:\smallskip\\
%%   HTTPS & 443 & 34,727\,K  & 4,029\,K (12\%) & 9,089\,K (26\%) & 17,490\,K & 2,523\,K (14\%) & 3,793\,K (22\%) \\
%%     (Alexa~1M) & 443 & 611\,K & 22\,K (4\%)  & 52\,K (9\%)     & 456\,K & 33\,K (7\%)     & 85\,K (19\%)    \\
%% \fi
  \bottomrule
   \end{tabularx}
   \caption{\textbf{Hosts vulnerable to general DROWN}\,---\,%
   We performed Internet-wide scans to measure the number of hosts supporting \ssltwo on several different protocols.  A host is vulnerable to DROWN if its public key is exposed anywhere via \ssltwo.  Overall vulnerability to DROWN is much larger than support for \ssltwo due to widespread reuse of keys.
   }
   \label{table:general}
  \end{table*}
}

\newcommand{\tabSpecialAll}{
\begin{table*}[t]
  \centering\small
  \begin{tabularx}{\textwidth}{Xrrrrrrr}
    \toprule
    & & \multicolumn{3}{c}{\it Any certificate} & \multicolumn{3}{c}{\it Trusted certificates} \\
    \cmidrule(lr){3-5} \cmidrule(lr){6-8}
    \textbf{Protocol} & \textbf{Port} & \multicolumn{1}{c}{\bf SSL/TLS} & \twolinecell{\bf Special DROWN\\\bf oracles} & \twolinecell{\bf Vulnerable\\\bf key} & \multicolumn{1}{c}{\bf SSL/TLS} & \twolinecell{\bf Vulnerable\\\bf key} & \twolinecell{\bf Vulnerable\\\bf name} \\
    \midrule
    SMTP  & 25  & 3,357\,K   & 855\,K (25\%)   & 896\,K (27\%)   & 1,083\,K  & 305\,K (28\%)   & 398\,K (37\%)   \\
    POP3  & 110 & 4,193\,K   & 397\,K \ns (9\%)    & 946\,K (23\%)   & 1,787\,K  & 485\,K (27\%)   & 674\,K (38\%)   \\
    IMAP  & 143 & 4,202\,K   & 457\,K (11\%)   & 969\,K (23\%)   & 1,781\,K  & 498\,K (30\%)   & 690\,K (39\%)   \\
    HTTPS & 443 & 34,727\,K  & 4,029\,K (12\%) & 9,089\,K (26\%) & 17,490\,K & 2,523\,K (14\%) & 3,793\,K (22\%) \\
    SMTPS & 465 & 3,596\,K   & 334\,K \ns (9\%)    & 765\,K (21\%)   & 1,641\,K  & 430\,K (26\%)   & 630\,K (38\%)   \\
    SMTP  & 587 & 3,507\,K   & 345\,K (10\%)   & 792\,K (23\%)   & 1,657\,K  & 482\,K (29\%)   & 667\,K (40\%)   \\
    IMAPS & 993 & 4,315\,K   & 892\,K (21\%)   & 1,073\,K (25\%) & 1,909\,K  & 602\,K (32\%)   & 792\,K (42\%)   \\
    POP3S & 995 & 4,322\,K   & 897\,K (21\%)   & 1,108\,K (26\%) & 1,974\,K  & 641\,K (32\%)   & 835\,K (42\%)   \\
    \midrule
    (Alexa~Top~1M) & 443 & 611\,K & 22\,K \ns (4\%)  & 52\,K \ns (9\%)     & 456\,K    & 33\,K \ns (7\%)     & 85\,K (19\%)    \\
    \bottomrule
  \end{tabularx}
   \caption{\textbf{Hosts vulnerable to special DROWN}\,---\,%
   A server is vulnerable to special DROWN if its key is exposed by a host with the CVE-2016-0703 bug. Since the attack is fast enough to enable man-in-the-middle attacks, a server is also vulnerable (to impersonation) if any name in its certificate is found in any trusted certificate with an exposed key.}
   \label{table:special}
\end{table*}
}

